{"version":3,"file":"ReactHookFormInput.js","names":["ReactHookFormInput","ref","Component","name","defaultValue","shouldUnregister","control","rules","onChange","onChange_","onBlur","onBlur_","rest","internalRef","useRef","setRef","useCallback","instance","current","undefined","renderInputComponent","restReactHookFormControlledFieldProps","useImperativeHandle","focus","setComponentRef","onChangeCombined","value","onBlurCombined","event","onFocus","props","field","React","forwardRef","propTypes","PropTypes","elementType","isRequired","string","bool","object","func"],"sources":["../../source/react-hook-form/ReactHookFormInput.js"],"sourcesContent":["import React, { useRef, useCallback, useImperativeHandle } from 'react'\nimport { Controller } from 'react-hook-form'\nimport PropTypes from 'prop-types'\n\nlet ReactHookFormInput = ({\n  Component,\n  name,\n  defaultValue,\n  shouldUnregister,\n  control,\n  rules,\n  onChange: onChange_,\n  onBlur: onBlur_,\n  ...rest\n}, ref) => {\n  const internalRef = useRef()\n\n  const setRef = useCallback((instance) => {\n    internalRef.current = instance\n    if (ref) {\n      if (typeof ref === 'function') {\n        ref(instance)\n      } else {\n        ref.current = instance\n      }\n    }\n  }, [ref])\n\n  // `feact-hook-form` doesn't know how to properly handle `undefined` values.\n  // https://github.com/react-hook-form/react-hook-form/issues/2990\n  defaultValue = defaultValue === undefined ? null : defaultValue\n\n  const renderInputComponent = ({\n    ref,\n    onChange,\n    onBlur,\n    // `restReactHookFormControlledFieldProps` contain properties like `name` and `value`.\n    // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\n    ...restReactHookFormControlledFieldProps\n  }) => {\n    // Setting `ref` passed by `react-hook-form` results in a bug:\n    // when an initial value is defined (example: \"+78005553535\")\n    // it seems to be set directly on the `ref`d `<input/>`\n    // by `react-hook-form` and the result is a non-formatted\n    // \"+78005553535\" initial value in the `<input/>`.\n    //\n    // To work around that bug, a fake `ref` is assigned,\n    // so that it could only `.focus()` it and no more.\n    //\n    // `useImperativeHandle()` hook seems to allow `ref` being `undefined`.\n    //\n    // if (ref) {\n      useImperativeHandle(ref, () => ({\n        focus() {\n          internalRef.current.focus()\n        }\n      }))\n    // }\n\n    const setComponentRef = useCallback((instance) => {\n      setRef(instance)\n      // if (ref) {\n      //   if (typeof ref === 'function') {\n      //     ref(instance)\n      //   } else {\n      //     ref.current = instance\n      //   }\n      // }\n    }, [ref, setRef])\n\n    const onChangeCombined = useCallback((value) => {\n      // `feact-hook-form` doesn't know how to properly handle `undefined` values.\n      // https://github.com/react-hook-form/react-hook-form/issues/2990\n      if (value === undefined) {\n        value = null\n      }\n      onChange(value)\n      if (onChange_) {\n        onChange_(value)\n      }\n    }, [\n      onChange,\n      onChange_\n    ])\n\n    const onBlurCombined = useCallback((event) => {\n      onBlur(event)\n      if (onBlur_) {\n        onBlur_(event)\n      }\n    }, [\n      onBlur,\n      onBlur_\n    ])\n\n    return (\n      <Component\n        {...rest}\n        {...restReactHookFormControlledFieldProps}\n        ref={setComponentRef}\n        onChange={onChangeCombined}\n        onBlur={onBlurCombined}/>\n    )\n  }\n\n  // `react-hook-form@7` no longer accepts `onFocus` property.\n  // Since this component can be used with both `v6` and `v7`,\n  // the `onFocus` property is left here.\n  const onFocus = useCallback(() => {\n    // internalRef.current.disabled = false\n    internalRef.current.focus()\n  }, [])\n\n  return (\n    <Controller\n      control={control}\n      name={name}\n      defaultValue={defaultValue}\n      shouldUnregister={shouldUnregister}\n      rules={rules}\n      onFocus={onFocus}\n      render={(props) => {\n        // Differentiate between `react-hook-form@6` and `react-hook-form@7`.\n        // https://react-hook-form.com/migrate-v6-to-v7/\n        // https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/57\n        // `props` (before v7) and `props.fields` (in v7) contain properties like:\n        // `ref`, `name`, `value`, `onChange`, `onBlur`.\n        // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\n        return renderInputComponent(props.field || props)\n      }}/>\n  )\n}\n\nReactHookFormInput = React.forwardRef(ReactHookFormInput)\n\nReactHookFormInput.propTypes = {\n  Component: PropTypes.elementType.isRequired,\n  name: PropTypes.string.isRequired,\n  defaultValue: PropTypes.string,\n  // A quote from `react-hook-form`:\n  // Without `shouldUnregister: true`, an input value would be retained when input is removed.\n  // Setting `shouldUnregister: true` makes the form behave more closer to native.\n  shouldUnregister: PropTypes.bool,\n  control: PropTypes.object.isRequired,\n  rules: PropTypes.object,\n  onChange: PropTypes.func,\n  onBlur: PropTypes.func\n}\n\nexport default ReactHookFormInput"],"mappings":"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"}
{"version":3,"file":"ReactHookFormInput.js","names":["React","useRef","useCallback","useImperativeHandle","Controller","PropTypes","ReactHookFormInput","ref","Component","name","defaultValue","shouldUnregister","control","rules","onChange","onChange_","onBlur","onBlur_","rest","internalRef","setRef","instance","current","undefined","renderInputComponent","restReactHookFormControlledFieldProps","focus","setComponentRef","onChangeCombined","value","onBlurCombined","event","onFocus","props","field","forwardRef","propTypes","elementType","isRequired","string","bool","object","func"],"sources":["../../source/react-hook-form/ReactHookFormInput.js"],"sourcesContent":["import React, { useRef, useCallback, useImperativeHandle } from 'react'\nimport { Controller } from 'react-hook-form'\nimport PropTypes from 'prop-types'\n\nlet ReactHookFormInput = ({\n  Component,\n  name,\n  defaultValue,\n  shouldUnregister,\n  control,\n  rules,\n  onChange: onChange_,\n  onBlur: onBlur_,\n  ...rest\n}, ref) => {\n  const internalRef = useRef()\n\n  const setRef = useCallback((instance) => {\n    internalRef.current = instance\n    if (ref) {\n      if (typeof ref === 'function') {\n        ref(instance)\n      } else {\n        ref.current = instance\n      }\n    }\n  }, [ref])\n\n  // `feact-hook-form` doesn't know how to properly handle `undefined` values.\n  // https://github.com/react-hook-form/react-hook-form/issues/2990\n  defaultValue = defaultValue === undefined ? null : defaultValue\n\n  const renderInputComponent = ({\n    ref,\n    onChange,\n    onBlur,\n    // `restReactHookFormControlledFieldProps` contain properties like `name` and `value`.\n    // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\n    ...restReactHookFormControlledFieldProps\n  }) => {\n    // Setting `ref` passed by `react-hook-form` results in a bug:\n    // when an initial value is defined (example: \"+78005553535\")\n    // it seems to be set directly on the `ref`d `<input/>`\n    // by `react-hook-form` and the result is a non-formatted\n    // \"+78005553535\" initial value in the `<input/>`.\n    //\n    // To work around that bug, a fake `ref` is assigned,\n    // so that it could only `.focus()` it and no more.\n    //\n    // `useImperativeHandle()` hook seems to allow `ref` being `undefined`.\n    //\n    // if (ref) {\n      useImperativeHandle(ref, () => ({\n        focus() {\n          internalRef.current.focus()\n        }\n      }))\n    // }\n\n    const setComponentRef = useCallback((instance) => {\n      setRef(instance)\n      // if (ref) {\n      //   if (typeof ref === 'function') {\n      //     ref(instance)\n      //   } else {\n      //     ref.current = instance\n      //   }\n      // }\n    }, [ref, setRef])\n\n    const onChangeCombined = useCallback((value) => {\n      // `feact-hook-form` doesn't know how to properly handle `undefined` values.\n      // https://github.com/react-hook-form/react-hook-form/issues/2990\n      if (value === undefined) {\n        value = null\n      }\n      onChange(value)\n      if (onChange_) {\n        onChange_(value)\n      }\n    }, [\n      onChange,\n      onChange_\n    ])\n\n    const onBlurCombined = useCallback((event) => {\n      onBlur(event)\n      if (onBlur_) {\n        onBlur_(event)\n      }\n    }, [\n      onBlur,\n      onBlur_\n    ])\n\n    return (\n      <Component\n        {...rest}\n        {...restReactHookFormControlledFieldProps}\n        ref={setComponentRef}\n        onChange={onChangeCombined}\n        onBlur={onBlurCombined}/>\n    )\n  }\n\n  // `react-hook-form@7` no longer accepts `onFocus` property.\n  // Since this component can be used with both `v6` and `v7`,\n  // the `onFocus` property is left here.\n  const onFocus = useCallback(() => {\n    // internalRef.current.disabled = false\n    internalRef.current.focus()\n  }, [])\n\n  return (\n    <Controller\n      control={control}\n      name={name}\n      defaultValue={defaultValue}\n      shouldUnregister={shouldUnregister}\n      rules={rules}\n      onFocus={onFocus}\n      render={(props) => {\n        // Differentiate between `react-hook-form@6` and `react-hook-form@7`.\n        // https://react-hook-form.com/migrate-v6-to-v7/\n        // https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/57\n        // `props` (before v7) and `props.fields` (in v7) contain properties like:\n        // `ref`, `name`, `value`, `onChange`, `onBlur`.\n        // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\n        return renderInputComponent(props.field || props)\n      }}/>\n  )\n}\n\nReactHookFormInput = React.forwardRef(ReactHookFormInput)\n\nReactHookFormInput.propTypes = {\n  Component: PropTypes.elementType.isRequired,\n  name: PropTypes.string.isRequired,\n  defaultValue: PropTypes.string,\n  // A quote from `react-hook-form`:\n  // Without `shouldUnregister: true`, an input value would be retained when input is removed.\n  // Setting `shouldUnregister: true` makes the form behave more closer to native.\n  shouldUnregister: PropTypes.bool,\n  control: PropTypes.object.isRequired,\n  rules: PropTypes.object,\n  onChange: PropTypes.func,\n  onBlur: PropTypes.func\n}\n\nexport default ReactHookFormInput"],"mappings":"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"}